<?xml version="1.0" encoding="UTF-8"?>
<templates>
    <!-- Define header content first -->
    <t t-name="hrm_theme.ChatWindowHeaderContent"
       t-inherit="mail.ChatWindow.headerContent"
       t-inherit-mode="primary">
        <xpath expr="//img[contains(@alt, 'Thread Image')]" position="attributes">
            <attribute name="class" remove="rounded " add="rounded-circle" separator=" "></attribute>
        </xpath>
    </t>

    <t t-name="hrm_theme.Composer.sendButton"
       t-inherit="mail.Composer.sendButton"
       t-inherit-mode="extension">
           <xpath expr="//button[contains(@class, 'o-mail-Composer-send')]" position="attributes">
               <attribute name="class"  add="d-block d-md-none"  separator=" "></attribute>
        </xpath>
    </t>

  <t t-name="hrm_theme.NavigableList"
       t-inherit="mail.NavigableList"
       t-inherit-mode="primary">
        <xpath expr="//div[contains(@class, 'o-mail-NavigableList')]" position="attributes">
            <attribute name="class" remove="bg-view" add="vt-bg-window-chat" separator=" "></attribute>
        </xpath>
    </t>

    <t t-name="hrm_theme.Thread"
       t-inherit="mail.Thread"
       t-inherit-mode="extension">
        <xpath expr="//div[contains(@class, 'o-mail-Thread')]" position="attributes">
            <attribute name="class" add="vt-bg-window-chat" separator=" "></attribute>
        </xpath>
    </t>

    <t t-name="hrm_theme.Composer"
       t-inherit="mail.Composer"
       t-inherit-mode="extension">
        <xpath expr="//div[contains(@class, 'o-mail-Composer-coreMain')]" position="after">
            <button class=" btn btn-success rounded-circle d-none d-md-block btn-sent d-xs-none d-sm-none d-md-block "
                    t-on-click="()=>this.sendMessage()">
                <i class="fa fa-paper-plane"></i>
            </button>
        </xpath>
        <xpath expr="//div[contains(@class, 'o-mail-Composer')]" position="attributes">
          <attribute name="class" remove="d-grid p-3" add="d-flex m-2 gap-2 align-items-center rounded-pill p-0" separator=" "></attribute>
          <attribute name="t-att-class">{
                    'px-3 pb-2': extended and !props.composer.message,
                    'o-extended': extended,
                    'o-isUiSmall': ui.isSmall,
                    'o-hasSelfAvatar py-1': !env.inChatWindow and thread,
                }</attribute>
        </xpath>
        <xpath expr="//textarea[contains(@class, 'o-mail-Composer-input')]" position="attributes">
          <attribute name="t-att-placeholder">"Nói điều gì đó"</attribute>
        </xpath>
    </t>

    <t t-name="hrm_themes.Message"
       t-inherit="mail.Message"
       t-inherit-mode="extension">
        <xpath expr="//div[contains(@class, 'o-mail-Message-core')]" position="attributes">
            <attribute name="class" add="align-items-center" separator=" "></attribute>
        </xpath>
        <xpath expr="//span[contains(@class, 'o-mail-Message-author')]" position="attributes">
            <attribute name="class" add="d-none" separator=" "></attribute>
        </xpath>
        <xpath expr="//t[@t-if='shouldDisplayAuthorName']" position="replace">
        </xpath>
        <xpath expr="//div[contains(@class, 'o-mail-Message-bubble')]" position="attributes">
            <attribute name="t-att-class">
                " "
            </attribute>
            <attribute name="t-attf-class">
                {{ isAlignedRight ? 'rounded-start-3' : 'rounded-end-3' }}
                {{ (message.isSelfAuthored and !message.is_note and !message.isHighlightedFromMention) ? 'bg-vt text-white' : '' }}
                {{ (!message.isSelfAuthored and !message.is_note and !message.isHighlightedFromMention) ? 'bg-white' : '' }}
                {{ message.isHighlightedFromMention ? 'bg-warning-light border border-warning opacity-50' : '' }}
            </attribute>
        </xpath>
        <xpath expr="//div[contains(@class, 'o-mail-Message-avatarContainer')]" position="attributes">
            <attribute name="class" remove="rounded" add="d-none" separator=" "></attribute>
        </xpath>
    </t>

    <!-- Extend the ChatWindow template -->
    <t t-name="hrm_theme.ChatWindow"
       t-inherit="mail.ChatWindow"
       t-inherit-mode="extension">
        <xpath expr="//div[contains(@class, 'o-mail-ChatWindow')]" position="attributes">
            <attribute name="class" add="vt-mail-ChatWindow" separator=" "></attribute>
        </xpath>
        <xpath expr="//div[contains(@class, 'o-mail-ChatWindow-header')]" position="attributes">
            <attribute name="class" remove="bg-100 " add="vt-bg-window-chat" separator=" "></attribute>
            <attribute name="t-att-class">
               { 'cursor-pointer': !ui.isSmall}
            </attribute>
        </xpath>
        <xpath expr="//t[@t-call='mail.ChatWindow.headerContent']" position="replace">
            <t t-call="hrm_theme.ChatWindowHeaderContent"/>
        </xpath>
    </t>
</templates>
